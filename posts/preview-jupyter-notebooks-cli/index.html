<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Read Jupyter notebooks from the command line | Tan Nian Wei</title><meta name=keywords content="python,data-science,terminal"><meta name=description content="For when just previews are enough"><meta name=author content><link rel=canonical href=https://tnwei.github.io/posts/preview-jupyter-notebooks-cli/><link crossorigin=anonymous href=/assets/css/stylesheet.min.3f18978ad811c7ac935d52e17228171d2a4141b9d8c9c35a5899222d655e34b8.css integrity="sha256-PxiXitgRx6yTXVLhcigXHSpBQbnYycNaWJkiLWVeNLg=" rel="preload stylesheet" as=style><link rel=icon href=https://tnwei.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://tnwei.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://tnwei.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://tnwei.github.io/apple-touch-icon.png><link rel=mask-icon href=https://tnwei.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.111.0"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-TCJ4MGEGS8"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-TCJ4MGEGS8")</script><style>figcaption{text-align:center}</style><meta property="og:title" content="Read Jupyter notebooks from the command line"><meta property="og:description" content="For when just previews are enough"><meta property="og:type" content="article"><meta property="og:url" content="https://tnwei.github.io/posts/preview-jupyter-notebooks-cli/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-04-25T18:10:00+08:00"><meta property="article:modified_time" content="2023-04-25T18:10:00+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Read Jupyter notebooks from the command line"><meta name=twitter:description content="For when just previews are enough"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://tnwei.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Read Jupyter notebooks from the command line","item":"https://tnwei.github.io/posts/preview-jupyter-notebooks-cli/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Read Jupyter notebooks from the command line","name":"Read Jupyter notebooks from the command line","description":"For when just previews are enough","keywords":["python","data-science","terminal"],"articleBody":"Jupyter notebooks enable data scientists to explore data and prototype solutions just like walking. Put your left foot forward (code), then your right foot (plot), then your left foot again (code), and rinse and repeat. This is in no small part thanks to the Javascript-based GUI that interfaces with Python kernels under the hood, to power the immediate interactivity that underlies the modern data science workflow.\nThis immediate interactivity is sorely felt when it is missing.\nDisplaying textual content in Jupyter notebooks should be fast Once I was going through code submitted by participants for a hackathon for archival purposes. I didn’t need to run any notebooks; just needed to skim through them as part of the process. There was one particular notebook that was full of graphs, generated by a couple of loops. Did you know that images in code cell outputs are stored as base64 encoded strings in the notebook itself? This particular notebook weighted in at \u003e60 MBs, and it froze my Jupyter Lab for a minute or two upon opening it.\nAlthough I don’t run into monster notebooks often, I run into similar productivity snags in my day to day frequent enough that I think about it. Sometimes I just want to quickly skim a notebook to refresh my memory / to look for something I forgot without intending to run the notebook1.\nJupyter notebooks tend to take a couple of seconds to load in Jupyter Lab. It would be nice if I can flip through content-heavy Jupyter notebooks with the same responsiveness of flipping through pages on a physical notebook. Jupyter notebooks are just specially formatted JSON! I shouldn’t need to start a Jupyter server if all I wanted to do is skim it quickly. Reading and displaying a Jupyter notebook JSON should be fast if we just opt to put plain text2 in front of eyeballs.\nWhy the command line? I ended up as a heavy command line user after getting used to doing everything on my work server over SSH. Plus, I already use charmbracelet/glow to render markdown in CLI, something similar will work just fine for me.\nLow hanging fruit: someone has implemented it! After studying the format of a Jupyter notebook (link to nbformat docs), I set out to find libraries for building TUI apps in Python (most comfortable language). I hit the jackpot when I came across textualize/rich-cli, which straight up can pretty print notebooks to terminal! It was as simple as pip install rich-cli, then rich notebook.ipynb.\nI wish there are more packages that just magically exist when I want to do something.\nTried it out, love how it looks. But this story has not come to an end just yet. When loading large notebooks, there was a perceptible lag of a few seconds before the rendered output shows up. Since we’re just rendering text here, I figured there’s a bottleneck somewhere that can be removed to make the output show up almost instantly.\nA minor tweak to fully scratch my itch After some tinkering, I found that the lag came from rich-cli preparing all notebook cells for rendering before dumping them to STDOUT all at once. Modifying the logic to render each cell directly before processing the next one is doable, but this breaks the built-in pagination: the pager in the underlying API (textualize/rich) will display each cell in their own pager instance if I do that. As a workaround, I used subprocess to pipe to less as a pager instead. Because of how bash pipe works, any output received is immediately flushed to STDOUT. Thus, regardless of notebook size, the first few cells are rendered in terminal almost instantly. Bingo!\nNow that the logic works as intended, I packaged the code as nbread and put it on github (tnwei/nbread), so that I can easily install it as a standalone command-line application with pipx.\nFrom good to awesome: integration with ranger file manager I happen to be a happy user of ranger, a command-line file manager that comes with a file preview pane. By default, Jupyter notebooks show up simply as raw JSON in the preview, and is opened as a text file when selected. Given the work done above, I saw how I can improve my user experience by configuring integration with nbread: I won’t even need to launch nbread manually; I can just open the notebook I want by finger-dancing on arrow keys!\nJust had to make the following changes:\nModify handle_extension() in ~/.config/ranger/scope.sh for file preview:\ncase \"$extension\" in ipynb) ¦ # Jupyter notebook previewer ¦ nbread \"${FILE_PATH}\" \u0026\u0026 { dump | trim; exit 5; } || exit 2;; And adding the following to ~/.config/ranger/rifle.conf to launch nbread when a Jupyter notebook is selected:\n# Jupyter notebooks ext ipynb = nbread \"$1\" --pager Conclusion and thoughts I ended up using the outcome of this little side project almost every day. It just works and doesn’t take much conscious thought to use. Here’s what using nbread in ranger looks like:\nWorks like a charm.\nCertainly, there are limitations: none of the rich media content like images and interactive widgets are visible (see footnote 2). However, as a preview tool, it works more than well enough for my purposes and successfully scratched my itch. So I’m happy with it.\nGithub repo link: (tnwei/nbread)\n*GPT it? Hmmm ↩︎\nWhat about the rich media formatting, you ask? One, typically I’m looking for textual content instead of rich content when skimming through notebooks: code or notes written in comments / markdown cells. And two, dealing with rich content will make this little side project more complex by a few orders of magnitude. I personally don’t think putting a lot of effort here is worth it. ↩︎ ↩︎\n","wordCount":"954","inLanguage":"en","datePublished":"2023-04-25T18:10:00+08:00","dateModified":"2023-04-25T18:10:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://tnwei.github.io/posts/preview-jupyter-notebooks-cli/"},"publisher":{"@type":"Organization","name":"Tan Nian Wei","logo":{"@type":"ImageObject","url":"https://tnwei.github.io/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://tnwei.github.io/ accesskey=h title="Tan Nian Wei (Alt + H)">Tan Nian Wei</a>
<span class=logo-switches></span></div><ul id=menu><li><a href=https://tnwei.github.io/writing/ title=Writing><span>Writing</span></a></li><li><a href="https://drive.google.com/file/d/1kWKGkamiCd7RZLssEBy3b-FT3r0jpwha/view?usp=sharing" title=Resume><span>Resume</span></a></li><li><a href=https://tnwei.github.io/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Read Jupyter notebooks from the command line</h1><div class=post-meta><span title='2023-04-25 18:10:00 +0800 +0800'>Apr 25, 2023 Tue</span>&nbsp;·&nbsp;5 min</div></header><div class=post-content><p>Jupyter notebooks enable data scientists to explore data and prototype solutions just like walking. Put your left foot forward (code), then your right foot (plot), then your left foot again (code), and rinse and repeat. This is in no small part thanks to the Javascript-based GUI that interfaces with Python kernels under the hood, to power the immediate interactivity that underlies the modern data science workflow.</p><p>This immediate interactivity is sorely felt when it is missing.</p><h2 id=displaying-textual-content-in-jupyter-notebooks-should-be-fast>Displaying textual content in Jupyter notebooks should be fast<a hidden class=anchor aria-hidden=true href=#displaying-textual-content-in-jupyter-notebooks-should-be-fast>#</a></h2><p>Once I was going through code submitted by participants for a hackathon for archival purposes. I didn&rsquo;t need to run any notebooks; just needed to skim through them as part of the process. There was one particular notebook that was full of graphs, generated by a couple of loops. Did you know that images in code cell outputs are stored as base64 encoded strings in the notebook itself? This particular notebook weighted in at >60 MBs, and it froze my Jupyter Lab for a minute or two upon opening it.</p><p>Although I don&rsquo;t run into monster notebooks often, I run into similar productivity snags in my day to day frequent enough that I think about it. Sometimes I just want to quickly skim a notebook to refresh my memory / to look for something I forgot without intending to run the notebook<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.</p><p>Jupyter notebooks tend to take a couple of seconds to load in Jupyter Lab. It would be nice if I can flip through content-heavy Jupyter notebooks with the same responsiveness of flipping through pages on a physical notebook. Jupyter notebooks are just specially formatted JSON! I shouldn&rsquo;t need to start a Jupyter server if all I wanted to do is skim it quickly. Reading and displaying a Jupyter notebook JSON should be fast if we just opt to put plain text<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> in front of eyeballs.</p><h2 id=why-the-command-line>Why the command line?<a hidden class=anchor aria-hidden=true href=#why-the-command-line>#</a></h2><p>I ended up as a heavy command line user after getting used to doing everything on my work server over SSH. Plus, I already use <a href=https://github.com/charmbracelet/glow>charmbracelet/glow</a> to render markdown in CLI, something similar will work just fine for me.</p><h2 id=low-hanging-fruit-someone-has-implemented-it>Low hanging fruit: someone has implemented it!<a hidden class=anchor aria-hidden=true href=#low-hanging-fruit-someone-has-implemented-it>#</a></h2><p>After studying the format of a Jupyter notebook (<a href=https://nbformat.readthedocs.io/en/latest/>link to nbformat docs</a>), I set out to find libraries for building TUI apps in Python (most comfortable language). I hit the jackpot when I came across <a href=https://github.com/Textualize/rich-cli>textualize/rich-cli</a>, which straight up can pretty print notebooks to terminal! It was as simple as <code>pip install rich-cli</code>, then <code>rich notebook.ipynb</code>.</p><figure class=align-center><img loading=lazy src=/images/rich-cli-screenshot.jpeg#center alt="Screnshot of previewing Jupyter notebooks in terminal with rich-cli"><figcaption><p>I wish there are more packages that just magically exist when I want to do something.</p></figcaption></figure><p>Tried it out, love how it looks. But this story has not come to an end just yet. When loading large notebooks, there was a perceptible lag of a few seconds before the rendered output shows up. Since we&rsquo;re just rendering text here, I figured there&rsquo;s a bottleneck somewhere that can be removed to make the output show up almost instantly.</p><h2 id=a-minor-tweak-to-fully-scratch-my-itch>A minor tweak to fully scratch my itch<a hidden class=anchor aria-hidden=true href=#a-minor-tweak-to-fully-scratch-my-itch>#</a></h2><p>After some tinkering, I found that the lag came from <code>rich-cli</code> preparing all notebook cells for rendering before dumping them to STDOUT all at once. Modifying the logic to render each cell directly before processing the next one is doable, but this breaks the built-in pagination: the pager in the underlying API (<a href=https://github.com/Textualize/rich/>textualize/rich</a>) will display each cell in their own pager instance if I do that. As a workaround, I used <code>subprocess</code> to pipe to <code>less</code> as a pager instead. Because of <a href=https://stackoverflow.com/a/9834118>how bash pipe works</a>, any output received is immediately flushed to STDOUT. Thus, regardless of notebook size, the first few cells are rendered in terminal almost instantly. Bingo!</p><p>Now that the logic works as intended, I packaged the code as <code>nbread</code> and put it on github (<a href=https://github.com/tnwei/nbread>tnwei/nbread</a>), so that I can easily install it as a standalone command-line application with <a href=https://github.com/pypa/pipx><code>pipx</code></a>.</p><h2 id=from-good-to-awesome-integration-with-ranger-file-manager>From good to awesome: integration with ranger file manager<a hidden class=anchor aria-hidden=true href=#from-good-to-awesome-integration-with-ranger-file-manager>#</a></h2><p>I happen to be a happy user of <a href=https://github.com/ranger/ranger><code>ranger</code></a>, a command-line file manager that comes with a file preview pane. By default, Jupyter notebooks show up simply as raw JSON in the preview, and is opened as a text file when selected. Given the work done above, I saw how I can improve my user experience by configuring integration with <code>nbread</code>: I won&rsquo;t even need to launch <code>nbread</code> manually; I can just open the notebook I want by finger-dancing on arrow keys!</p><p>Just had to make the following changes:</p><p>Modify <code>handle_extension()</code> in <code>~/.config/ranger/scope.sh</code> for file preview:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#34;</span>$extension<span style=color:#e6db74>&#34;</span> in
</span></span><span style=display:flex><span>    ipynb<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    ¦   <span style=color:#75715e># Jupyter notebook previewer</span>
</span></span><span style=display:flex><span>    ¦   nbread <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>FILE_PATH<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>{</span> dump | trim; exit 5; <span style=color:#f92672>}</span> <span style=color:#f92672>||</span> exit 2;;
</span></span></code></pre></div><p>And adding the following to <code>~/.config/ranger/rifle.conf</code> to launch <code>nbread</code> when a Jupyter notebook is selected:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span># Jupyter notebooks
</span></span><span style=display:flex><span>ext ipynb = nbread &#34;$1&#34; --pager
</span></span></code></pre></div><h2 id=conclusion-and-thoughts>Conclusion and thoughts<a hidden class=anchor aria-hidden=true href=#conclusion-and-thoughts>#</a></h2><p>I ended up using the outcome of this little side project almost every day. It just works and doesn&rsquo;t take much conscious thought to use. Here&rsquo;s what using <code>nbread</code> in <code>ranger</code> looks like:</p><figure class=align-center><img loading=lazy src=/images/nbread-cast.svg#center alt="Asciicast of previewing Jupyter notebooks in ranger file manager"><figcaption><p>Works like a charm.</p></figcaption></figure><p>Certainly, there are limitations: none of the rich media content like images and interactive widgets are visible (see footnote <sup id=fnref1:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>). However, as a preview tool, it works more than well enough for my purposes and successfully scratched my itch. So I&rsquo;m happy with it.</p><p>Github repo link: (<a href=https://github.com/tnwei/nbread>tnwei/nbread</a>)</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>*GPT it? Hmmm&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>What about the rich media formatting, you ask? One, typically I&rsquo;m looking for textual content instead of rich content when skimming through notebooks: code or notes written in comments / markdown cells. And two, dealing with rich content will make this little side project more complex by a few orders of magnitude. I personally don&rsquo;t think putting a lot of effort here is worth it.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref1:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://tnwei.github.io/tags/python/>python</a></li><li><a href=https://tnwei.github.io/tags/data-science/>data-science</a></li><li><a href=https://tnwei.github.io/tags/terminal/>terminal</a></li></ul></footer><script src=https://giscus.app/client.js data-repo=tnwei/tnwei.github.io data-repo-id=R_kgDOGmOfvQ data-category=Announcements data-category-id=DIC_kwDOGmOfvc4CAeit data-mapping=og:title data-reactions-enabled=0 data-emit-metadata=0 data-theme=light data-lang=en crossorigin=anonymous async></script><noscript></noscript></article></main><footer class=footer><span>&copy; 2025 <a href=https://tnwei.github.io/>Tan Nian Wei</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>